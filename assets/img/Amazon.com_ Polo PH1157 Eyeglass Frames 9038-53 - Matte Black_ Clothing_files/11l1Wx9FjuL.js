(function(p,n,v){p.execute(function(){p.when("A","dp-refresh-handler").register("page-refresh-view",function(d,h){var g=d.$;return function(e,c,b){function f(){g.each(c.contextMetaData,function(a,k){var b={},l=k.elementList||[],c=l.length,f=[];b.click={};b.mouseOver={};for(var d=0;d<c;d++){var r=g("#"+l[d].divToUpdate);f.push("#"+l[d].divToUpdate);r.length&&l[d].customClientFunction&&(l[d].updateOnHover&&(b.mouseOver[l[d].divToUpdate]=r.attr("customfunctionname")),b.click[l[d].divToUpdate]=r.attr("customfunctionname"))}u.config[a].affectedFeatures=
f.join(",");u.config[a].clientFeatures=b})}function m(a,k,b){g.each(u.config[b].clientFeatures.click,function(b,l){try{var c=v,c=eval(l);c(k,DetailPage.StateController,function(){u.twisterRefreshHandler.stampImageLoad(a)})}catch(f){M.logFatal("Client feature - "+b+", threw and exception :- "+f)}})}function a(a,k,b,c){var f={},r={};f.asinList=a;f.id="parent"===b?a:"partial"===c?k:a;f.mType=b;f=l(b,f);b=!1;(c=d.state("pwState"))&&(b=c.isTryState);b&&(f.isTryState=b);f=u.twisterRefreshHandler.createCustomParamsMap({},
f);r.asin=a;r.id=k;return{twisterRefreshParams:f,notifyClientParams:r}}function l(a,k){g.each(c.contextMetaData[a].mTypeSpecificURLParams,function(a,b){k[a]=b});return k}function k(a){a=u.twisterUtil.getSelectionInfoFromSelectedVariationValuesMap(a.selected_variation_values);u.twisterUtil.isFullySelected(a)?u.currentPageSelectionState="full":u.currentPageSelectionState="partial"}function r(a){var k={};a=a.twisterUpdateURLInfo.immutableURLPrefix;a+="&isFlushing=2&dpEnvironment="+Twister.dpEnvironment;
k.pageRefreshUrl=a;return k}function t(a){var k={};k.config=a.measurement;k.dimensionDisplayType=a.dimensionsDisplayType;k.storeID=a.storeID;k.productGroupID=a.productGroupID;return k}function q(a,k){var b;"partial"===a&&"partial"===k&&(b="partial");"partial"===a&&"full"===k&&(b="full");"full"===a&&"partial"===k&&(b="parent");"full"===a&&"full"===k&&(b="full");return b}var u=this,z=n.ue,M=new b("dpTwisterPageRefreshView");this.twisterUtil=e.util;this.twisterFeatureName="Twister";this.currentPageSelectionState;
this.twisterRefreshHandler;this.config={partial:{},full:{},parent:{},master:{}};this.hiddenFeatures={intermediateEOS:1,EOS:1};var y=function(a){z&&z.count&&z.count(a,(z.count(a)||0)+1)};(function(){k(c);f();var b={featureName:u.twisterFeatureName},l=r(c),d=t(c);u.twisterRefreshHandler=new h(b,l,d);e.registerPassive({viewAttribution:"DetailPage",viewName:"WebTwisterRefresh"},{updateView:function(k,b){if("METADATA"===k){var l=b.newDimCombID,f=b.childAsin,d=b.newAsin,r=u.twisterUtil.isFullySelected(l)?
"full":"partial",e=q(u.currentPageSelectionState,r),t="parent"===e?!0:!1,h={},z=[];"parent"===e?(h=a(d,l,"parent",r),z.parent=h,h=a(f,l,"partial",r),z.partial=h):(h=a(f,l,e,r),z[e]=h);var l={chunk:function(a){var k=a.ASIN,b=a.Value;a=a.FeatureName;if(!u.hiddenFeatures[a]){var l,c;try{a&&b&&b.content&&(c=b.content[a],"undefined"!==typeof c&&(l=g("#"+a),l.html(c),l.css({opacity:""})))}catch(f){a=a||"NoFeatureName",M.logFatal(f,{message:"Error in feature"+a})}u.twisterRefreshHandler.stampFeature(a,k)}},
success:function(a,k,b){y("twisterUpdateSuccess")},error:function(a,k,b){Twister.$("#variations-overlay").hide();y("twisterUpdateFailure");Twister.showErrorMessageOnFailure&&(alert(Twister.errorMessageOnFailure),location.reload())},abort:function(a){M.logFatal("Ajax aborted: "+a)},timeout:4E4},n;for(n in z)if(z.hasOwnProperty(n)){if("full"===n){var p;null!=typeof b.divMetaData&&(p=b.divMetaData.dimDisplayType);h=u.twisterUtil.getDimensionInfo().length;u.twisterRefreshHandler.startMeasurement(d,p,
h,c.dimensionsDisplayType)}g(u.config[n].affectedFeatures).css({opacity:.5});h=z[n].twisterRefreshParams;f=z[n].notifyClientParams;u.twisterRefreshHandler.doPageRefresh(null,h,l,t);m(f.asin,f.id,n)}u.currentPageSelectionState=r}}})})()}})})})(function(){var p=window.AmazonUIPageJS||window.P,n=p._namespace||p.attributeErrors;return n?n("DetailPageTwisterViewAsset"):p}(),window);